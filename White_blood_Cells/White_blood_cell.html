<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<meta name="date" content="2019-03-13" />

<title>White Blood Cell Classification</title>

<script src="White_blood_cell_files/jquery-1.12.4/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="White_blood_cell_files/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="White_blood_cell_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="White_blood_cell_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="White_blood_cell_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="White_blood_cell_files/navigation-1.1/tabsets.js"></script>
<script src="White_blood_cell_files/navigation-1.1/codefolding.js"></script>
<script src="White_blood_cell_files/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="White_blood_cell_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="White_blood_cell_files/datatables-binding-0.5/datatables.js"></script>
<link href="White_blood_cell_files/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="White_blood_cell_files/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="White_blood_cell_files/dt-core-1.10.16/js/jquery.dataTables.min.js"></script>
<link href="White_blood_cell_files/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="White_blood_cell_files/crosstalk-1.0.0/js/crosstalk.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>





<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">White Blood Cell Classification</h1>
<h4 class="date"><em>2019-03-13</em></h4>

</div>

<div id="TOC">
<ul>
<li><a href="#introduction"><span class="toc-section-number">1</span> Introduction</a><ul>
<li><a href="#motivation"><span class="toc-section-number">1.1</span> Motivation</a></li>
<li><a href="#load-package"><span class="toc-section-number">1.2</span> load package</a></li>
<li><a href="#dataset-description"><span class="toc-section-number">1.3</span> Dataset description</a><ul>
<li><a href="#glimpse-of-digital-slide"><span class="toc-section-number">1.3.1</span> Glimpse of digital slide</a></li>
<li><a href="#glimpse-of-the-4-white-blood-cell-types"><span class="toc-section-number">1.3.2</span> Glimpse of the 4 White Blood Cell types</a></li>
</ul></li>
<li><a href="#description-of-the-first-dataset"><span class="toc-section-number">1.4</span> Description of the First Dataset</a></li>
<li><a href="#exploration-and-transformation-of-the-first-dataset"><span class="toc-section-number">1.5</span> Exploration and Transformation of the first dataset</a><ul>
<li><a href="#transformation-of-labels.csv-file"><span class="toc-section-number">1.5.1</span> Transformation of <code>labels.csv</code> file</a></li>
<li><a href="#explore-and-transform-xml-file"><span class="toc-section-number">1.5.2</span> Explore and Transform XML file</a></li>
<li><a href="#function-to-extract-x-y-limits-of-wbc-from-xml-files"><span class="toc-section-number">1.5.3</span> Function to extract x, y limits of WBC from xml files</a></li>
<li><a href="#group-all-x-y-limits-of-wbc-into-dataframe"><span class="toc-section-number">1.5.4</span> Group all x, y limits of WBC into dataframe</a></li>
<li><a href="#explore-only-image-with-multiple-wbc"><span class="toc-section-number">1.5.5</span> Explore only image with multiple WBC</a></li>
<li><a href="#merge-all-needed-informations-of-images-with-multiple-wbc-into-dataframe"><span class="toc-section-number">1.5.6</span> Merge all needed informations of images with multiple WBC into dataframe</a></li>
<li><a href="#function-to-plot-cropped-wbc-from-images"><span class="toc-section-number">1.5.7</span> Function to plot cropped WBC from images</a></li>
<li><a href="#merge-all-needed-informations-of-all-images-in-dataset-master-into-dataframe"><span class="toc-section-number">1.5.8</span> Merge all needed informations of all images in dataset-master into dataframe</a></li>
</ul></li>
<li><a href="#description-of-the-second-dataset"><span class="toc-section-number">1.6</span> Description of the second dataset</a></li>
</ul></li>
</ul>
</div>

<div id="introduction" class="section level1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p>Medical Image Analysis is a widely used method to screen and diagnose diseases. Depending of the part or tissue of the body would check, we can subset imaging Technics into 2 big methods. First the methods that use rays, like x-ray, Nuclear Magnetic Resonance (NMR) or Scintigraphy. In general, the images generated by these methods are as a photographic film (black and white). The advantage of these methods is that we can observe body through tissues and have access to internal parts without chirurgy. The inconvenient is that these methods uses ionizing radiation (dangerous for health) and mainly expensive. There are at less two kaggle competition with this type of images: <a href="https://www.kaggle.com/nih-chest-xrays/data">NIH Chest X-rays</a> and <a href="https://www.kaggle.com/paultimothymooney/chest-xray-pneumonia">Chest X-Ray Images (Pneumonia)</a> The second kind of medical imaging is applied to all type of tissues or physiological fluid (plasma, blood). The samples are prepared on glass slide and stained with Hematoxylin and eosin stain <a href="https://en.wikipedia.org/wiki/H%26E_stain">(H&amp;E)</a>. This technique is very old and widely used for several medical screening and diagnostics. H&amp;E staining is not expensive but needs Human intervention and the processing takes a while. The interpretation of the images also needs multiple experts (pathologist) to visualize and diagnose slides mainly through microscopes. the analysis remains subjective and could differ between pathologists.</p>
<p>On the other hand, the H&amp;E stains are routinely prepared by technicians who become overwhelmed by the increasing number of samples. Likewise, pathologists are over-worked by the microscopic observation and interpretation, causing overflow that may result in diagnostic error.</p>
<div id="motivation" class="section level2">
<h2><span class="header-section-number">1.1</span> Motivation</h2>
<p>A computational grading of slides using learning machine may help to make a pre-screening a hundred or thousand or slides before Human verification.</p>
</div>
<div id="load-package" class="section level2">
<h2><span class="header-section-number">1.2</span> load package</h2>
</div>
<div id="dataset-description" class="section level2">
<h2><span class="header-section-number">1.3</span> Dataset description</h2>
<p>The images of this competition shows blood cell spread on glass slide and stained by H&amp;E method. We can visualize red blood cell and immune cells. It is easy to make a difference between these two kind of cells. The coloration is not the same, red cells are red but immune cell are purple.</p>
<div id="glimpse-of-digital-slide" class="section level3">
<h3><span class="header-section-number">1.3.1</span> Glimpse of digital slide</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(EBImage)
path_to_dataset &lt;-<span class="st"> &quot;dataset-master/JPEGImages/&quot;</span>
img &lt;-<span class="st"> </span><span class="kw">readImage</span>(<span class="kw">paste0</span>(path_to_dataset, <span class="st">&quot;BloodImage_00000.jpg&quot;</span>))
img_resize =<span class="st"> </span><span class="kw">resize</span>(img, <span class="dt">w=</span><span class="dv">128</span>, <span class="dt">h=</span><span class="dv">128</span>)

<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) <span class="co"># , mai=c(0.1,0.1,0.2,0.1), oma=c(3,3,3,3)</span>
<span class="kw">plot</span>(img_resize)
<span class="kw">title</span>( <span class="dt">main =</span> <span class="st">&quot;plot function&quot;</span>)
<span class="kw">display</span>(img_resize, <span class="dt">method =</span> <span class="st">&quot;raster&quot;</span>, <span class="dt">all =</span> <span class="ot">TRUE</span>, <span class="dt">margin =</span> <span class="dv">1</span>)
<span class="kw">title</span>( <span class="dt">main =</span> <span class="st">&quot;display function&quot;</span>)</code></pre></div>
<p><img src="White_blood_cell_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<ul>
<li><p>We observe one purple cell which is a white blood cell. The other cells are read blood cell.</p></li>
<li><p>There are 4 types of immune cells, named also White Blood Cells (WBC).</p></li>
</ul>
</div>
<div id="glimpse-of-the-4-white-blood-cell-types" class="section level3">
<h3><span class="header-section-number">1.3.2</span> Glimpse of the 4 White Blood Cell types</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">path_to_dataset2 &lt;-<span class="st"> &quot;dataset2-master/images/TEST_SIMPLE/&quot;</span>
img_eosinophil &lt;-<span class="st"> </span><span class="kw">readImage</span>(<span class="kw">paste0</span>(path_to_dataset2, <span class="st">&quot;EOSINOPHIL/_0_5239.jpeg&quot;</span>))
img_lymphocyte &lt;-<span class="st"> </span><span class="kw">readImage</span>(<span class="kw">paste0</span>(path_to_dataset2, <span class="st">&quot;LYMPHOCYTE/_0_3975.jpeg&quot;</span>)) 
img_monocyte &lt;-<span class="st"> </span><span class="kw">readImage</span>(<span class="kw">paste0</span>(path_to_dataset2, <span class="st">&quot;MONOCYTE/_0_5020.jpeg&quot;</span>)) 
img_neutrophil &lt;-<span class="st"> </span><span class="kw">readImage</span>(<span class="kw">paste0</span>(path_to_dataset2, <span class="st">&quot;NEUTROPHIL/_0_1966.jpeg&quot;</span>)) 
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))
graphics<span class="op">::</span><span class="kw">plot</span>(img_eosinophil)
<span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;EOSINOPHIL white cell&quot;</span>)
<span class="kw">plot</span>(img_lymphocyte)
<span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;LYMPHOCUTE white cell&quot;</span>)
<span class="kw">plot</span>(img_monocyte)
<span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;MONOCYTE white cell&quot;</span>)
<span class="kw">plot</span>(img_neutrophil)
<span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;NEUTROPHIL white cell&quot;</span>)</code></pre></div>
<p><img src="White_blood_cell_files/figure-html/unnamed-chunk-3-1.png" width="1152" /></p>
</div>
</div>
<div id="description-of-the-first-dataset" class="section level2">
<h2><span class="header-section-number">1.4</span> Description of the First Dataset</h2>
<p>The first dataset directory names <code>dataset-master</code> contains 3 folders:</p>
<ul>
<li>JPEGImages that has 366 jpeg images</li>
<li>csv file that list the image label and the white cell type that has.</li>
<li>XML annotation folder that frame the different kind of cells in each image (343 XML files).
<ul>
<li>Green square for red blood cell (RB)</li>
<li>Red square for white blood cell (WBC)</li>
<li>Blue square for Platelets</li>
</ul></li>
</ul>
<p>Example of image with annotation: <a href="https://github.com/Shenggan/BCCD_Dataset/blob/master/example.jpg"><img src="https://github.com/Shenggan/BCCD_Dataset/blob/master/example.jpg" alt="link to image" /></a></p>
</div>
<div id="exploration-and-transformation-of-the-first-dataset" class="section level2">
<h2><span class="header-section-number">1.5</span> Exploration and Transformation of the first dataset</h2>
<div id="transformation-of-labels.csv-file" class="section level3">
<h3><span class="header-section-number">1.5.1</span> Transformation of <code>labels.csv</code> file</h3>
<p>Labels associate cells type. We can find Red Blood Cell (RBC), Platelets, and 4 types of White Bolld Cells (WBC).</p>
<p>We renamed images as its files names. Some image have two kind of WBC.</p>
<p>We need to crop each cell from image and rang it to associated category.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># glimpse csv file</span>
path_to_csv &lt;-<span class="st"> &quot;dataset-master/labels.csv&quot;</span>
label &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file =</span> path_to_csv)

<span class="co"># Rename images like files</span>
WBC_seprate_multiple_label &lt;-<span class="st"> </span>label <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">file_name =</span> <span class="kw">case_when</span>(
           Image <span class="op">%in%</span><span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">9</span> <span class="op">~</span><span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;BloodImage_0000&quot;</span>, Image), 
           Image <span class="op">%in%</span><span class="st"> </span><span class="dv">10</span><span class="op">:</span><span class="dv">99</span> <span class="op">~</span><span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;BloodImage_000&quot;</span>, Image),        
           Image <span class="op">%in%</span><span class="st"> </span><span class="dv">100</span><span class="op">:</span><span class="dv">999</span> <span class="op">~</span><span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;BloodImage_00&quot;</span>, Image),
                  <span class="ot">TRUE</span>                    <span class="op">~</span><span class="st"> &quot;huh?&quot;</span>
           ))<span class="op">%&gt;%</span>
<span class="st"> </span><span class="kw">select</span>(file_name, Image, Category) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># Separate categories in the same image</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">separate_rows</span>(Category)

<span class="co"># Rename differently the cropped cells from the same image</span>
<span class="co"># This step is essential when we woulf join labels with annotations</span>
WBC_seprate_multiple_label &lt;-
WBC_seprate_multiple_label <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(file_name) <span class="op">%&gt;%</span>
<span class="st">       </span><span class="kw">mutate</span>(<span class="dt">new_file_name =</span> <span class="cf">if</span>(<span class="kw">n</span>( ) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>) {<span class="kw">paste0</span>(file_name,<span class="st">&quot;_&quot;</span> , <span class="kw">row_number</span>( ))} 
                             <span class="cf">else</span> {<span class="kw">paste0</span>(file_name)})

WBC_seprate_multiple_label</code></pre></div>
<pre><code>## # A tibble: 426 x 4
## # Groups:   file_name [411]
##    file_name        Image Category   new_file_name   
##    &lt;chr&gt;            &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;           
##  1 BloodImage_00000     0 NEUTROPHIL BloodImage_00000
##  2 BloodImage_00001     1 NEUTROPHIL BloodImage_00001
##  3 BloodImage_00002     2 NEUTROPHIL BloodImage_00002
##  4 BloodImage_00003     3 NEUTROPHIL BloodImage_00003
##  5 BloodImage_00004     4 NEUTROPHIL BloodImage_00004
##  6 BloodImage_00005     5 NEUTROPHIL BloodImage_00005
##  7 BloodImage_00006     6 NEUTROPHIL BloodImage_00006
##  8 BloodImage_00007     7 NEUTROPHIL BloodImage_00007
##  9 BloodImage_00008     8 BASOPHIL   BloodImage_00008
## 10 BloodImage_00009     9 EOSINOPHIL BloodImage_00009
## # … with 416 more rows</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dplyr<span class="op">::</span><span class="kw">glimpse</span>(WBC_seprate_multiple_label )</code></pre></div>
<pre><code>## Observations: 426
## Variables: 4
## Groups: file_name [411]
## $ file_name     &lt;chr&gt; &quot;BloodImage_00000&quot;, &quot;BloodImage_00001&quot;, &quot;BloodImag…
## $ Image         &lt;int&gt; 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 10, 11, 12, 13, …
## $ Category      &lt;chr&gt; &quot;NEUTROPHIL&quot;, &quot;NEUTROPHIL&quot;, &quot;NEUTROPHIL&quot;, &quot;NEUTROP…
## $ new_file_name &lt;chr&gt; &quot;BloodImage_00000&quot;, &quot;BloodImage_00001&quot;, &quot;BloodImag…</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># glimpse image name </span>
dplyr<span class="op">::</span><span class="kw">glimpse</span>(<span class="kw">list.files</span>(<span class="st">&quot;dataset-master/JPEGImages/&quot;</span>))</code></pre></div>
<pre><code>##  chr [1:364] &quot;BloodImage_00000.jpg&quot; &quot;BloodImage_00001.jpg&quot; ...</code></pre>
<ul>
<li><strong>NB: there is no the same number of labels (441) and images (366)</strong></li>
<li><strong>There is 426 - 411 images with multiple WBC</strong></li>
</ul>
</div>
<div id="explore-and-transform-xml-file" class="section level3">
<h3><span class="header-section-number">1.5.2</span> Explore and Transform XML file</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Path_to_xml_file_<span class="dv">9</span> &lt;-<span class="st"> &quot;dataset-master/Annotations/BloodImage_00009.xml&quot;</span>
xml9 &lt;-<span class="st"> </span>XML<span class="op">::</span><span class="kw">xmlParse</span>(Path_to_xml_file_<span class="dv">9</span>)
xml_df &lt;-<span class="st"> </span>XML<span class="op">::</span><span class="kw">xmlToDataFrame</span>(Path_to_xml_file_<span class="dv">9</span>)
DT<span class="op">::</span><span class="kw">datatable</span>(xml_df)</code></pre></div>
<div id="htmlwidget-485e090cfdb9fe27cbb2" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-485e090cfdb9fe27cbb2">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],["JPEGImages","BloodImage_00009.jpg","/home/pi/detection_dataset/JPEGImages/BloodImage_00009.jpg",null,null,"0",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,"Unknown",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,"640",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,"480",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,"3",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,"WBC","RBC","RBC","RBC","RBC","RBC","RBC","RBC","RBC","RBC","RBC","RBC","RBC","RBC","RBC","Platelets","RBC","RBC"],[null,null,null,null,null,null,"Unspecified","Unspecified","Unspecified","Unspecified","Unspecified","Unspecified","Unspecified","Unspecified","Unspecified","Unspecified","Unspecified","Unspecified","Unspecified","Unspecified","Unspecified","Unspecified","Unspecified","Unspecified"],[null,null,null,null,null,null,"0","0","0","0","0","0","1","0","1","0","0","0","1","1","0","0","0","1"],[null,null,null,null,null,null,"0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"],[null,null,null,null,null,null,"23137255423","441324575423","372192468279","305213401300","226288324439","313318408414","282384377480","44697567206","440156196","214107331198","29885435211","776133197","1111594","286139465","15413289127","452415493449","479155575242","135393231480"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>text<\/th>\n      <th>database<\/th>\n      <th>width<\/th>\n      <th>height<\/th>\n      <th>depth<\/th>\n      <th>name<\/th>\n      <th>pose<\/th>\n      <th>truncated<\/th>\n      <th>difficult<\/th>\n      <th>bndbox<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"order":[],"autoWidth":false,"orderClasses":false,"columnDefs":[{"orderable":false,"targets":0}]}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#print(xml_df[[&#39;bndbox&#39;]])</span></code></pre></div>
<p>We converted an example of xml file to dataframe. We find intersting information about the x,y coordinates of cells.</p>
<ul>
<li><p><code>bndbox</code> column show the x and y limits of the annotations. We need to extract xmin, ymin, xmax, and ymax.</p></li>
<li><p><code>name</code> column indicates the type of cells.</p></li>
</ul>
<p>Here the coordonate of multiple RBC are poorly represented. We observe a cancatenation of 4 coordinates: xmin, xmax, ymin, ymax.</p>
<p>I opened multiple xml file and I did not find WBC cell with its x, y limits.</p>
<p>You can use <code>extract_square_of_WBC(&quot;dataset-master/Annotations/BloodImage_00019.xml&quot;)</code> function and change the name of the image.</p>
<p>The output does not have WCB sample. In actual document the code was run with the dataset download from github.</p>
<ul>
<li><strong>I replaced Dataset-master/Annotations and Dataset_master/JPEGImages from github</strong></li>
</ul>
<p><a href="https://github.com/Shenggan/BCCD_Dataset/tree/master/BCCD">link to github</a></p>
<ul>
<li><strong>At first view it seems updated and xml files have WBC annotations wich is not available for kaggle dataset version</strong></li>
</ul>
</div>
<div id="function-to-extract-x-y-limits-of-wbc-from-xml-files" class="section level3">
<h3><span class="header-section-number">1.5.3</span> Function to extract x, y limits of WBC from xml files</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Extract annotation of cell  as dataframe (square limits)</span>
extract_square_of_WBC &lt;-<span class="st"> </span><span class="cf">function</span>(file_path){
xml_obj &lt;-<span class="st"> </span>XML<span class="op">::</span><span class="kw">xmlParse</span>(file_path)

xml_obj_df &lt;-<span class="st"> </span><span class="kw">bind_cols</span>(  <span class="co"># or cbind()</span>
## print the name of cell
<span class="kw">xmlToDataFrame</span>(<span class="kw">getNodeSet</span>(xml_obj, <span class="st">&quot;//name&quot;</span>),<span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span>),
<span class="co"># print dimension</span>
<span class="kw">xmlToDataFrame</span>(<span class="kw">getNodeSet</span>(xml_obj, <span class="st">&quot;//object/bndbox&quot;</span>), <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
)

xml_obj_df <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rename</span>( <span class="st">&quot;Cells&quot;</span> =<span class="st"> </span>text) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">xmin =</span> <span class="kw">as.numeric</span>(xmin)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ymin =</span> <span class="kw">as.numeric</span>(ymin)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">xmax =</span> <span class="kw">as.numeric</span>(xmax)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ymax =</span> <span class="kw">as.numeric</span>(ymax)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(Cells <span class="op">==</span><span class="st"> &quot;WBC&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">file_name =</span> <span class="kw">basename</span>(file_path))
}
<span class="kw">extract_square_of_WBC</span>(<span class="st">&quot;dataset-master/Annotations/BloodImage_00019.xml&quot;</span>)</code></pre></div>
<pre><code>##   Cells xmin ymin xmax ymax            file_name
## 1   WBC  107   97  295  267 BloodImage_00019.xml</code></pre>
</div>
<div id="group-all-x-y-limits-of-wbc-into-dataframe" class="section level3">
<h3><span class="header-section-number">1.5.4</span> Group all x, y limits of WBC into dataframe</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## get all squares of WBC cell for all images
Path_to_xml_file_list &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="st">&quot;dataset-master/Annotations&quot;</span>,<span class="dt">full.names =</span> <span class="ot">TRUE</span>)
ls_df &lt;-<span class="st"> </span><span class="kw">lapply</span>(Path_to_xml_file_list, <span class="cf">function</span>(x) <span class="kw">extract_square_of_WBC</span>(x))
xy_limits_WCB &lt;-<span class="st"> </span><span class="kw">do.call</span>(<span class="st">&quot;rbind&quot;</span>,ls_df)

DT<span class="op">::</span><span class="kw">datatable</span>(xy_limits_WCB)</code></pre></div>
<div id="htmlwidget-61ca7fd141b0a1c0cf3c" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-61ca7fd141b0a1c0cf3c">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372"],["WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC"],[260,68,283,127,109,230,117,193,42,23,23,239,109,2,31,236,145,151,128,302,107,352,330,108,98,310,387,255,75,1,127,287,158,129,350,310,183,107,421,415,107,242,261,116,76,498,196,1,491,312,278,200,156,172,113,106,145,153,274,165,211,209,91,366,28,253,404,435,137,1,341,167,375,173,189,211,6,166,98,134,92,1,301,257,91,71,192,254,306,240,210,282,9,307,193,268,178,224,398,364,135,259,374,157,247,363,268,142,1,62,257,224,200,242,160,268,295,104,400,172,238,46,250,106,227,269,239,57,211,40,421,300,339,255,58,278,128,354,6,202,339,168,260,191,110,279,124,170,1,225,55,143,179,258,188,211,107,306,176,253,173,293,251,93,159,188,181,423,412,360,418,337,555,317,400,243,73,345,324,389,170,253,150,482,424,244,285,343,279,329,365,63,274,73,415,326,262,272,140,251,243,262,210,152,192,196,172,1,218,318,232,190,206,242,371,249,17,285,326,77,132,184,149,70,164,125,309,161,195,241,283,217,174,221,15,205,274,170,100,234,240,2,87,124,75,245,183,1,193,188,270,221,337,318,244,216,142,28,216,181,1,153,251,126,185,314,123,334,118,204,172,120,176,174,305,1,46,170,190,285,143,123,59,194,78,101,180,92,250,184,160,72,131,307,22,277,141,209,279,244,228,295,236,265,280,127,244,185,239,356,111,183,74,402,162,319,62,202,178,379,294,262,117,330,117,383,1,246,215,27,325,1,1,23,1,324,240,175,132,185,1,211,374,79,171,22,10,158,225,393,218,153,202,25,1,147,207,128,210,114,235,247,187,117,454,70,115,338,472,310,78,367],[177,315,1,40,134,288,190,92,183,137,229,253,119,187,208,211,4,118,215,1,97,364,302,194,34,1,1,1,179,191,143,364,77,109,181,351,285,242,302,304,212,117,219,192,106,304,257,40,21,1,147,151,248,1,232,12,61,134,236,71,4,173,261,295,129,275,107,194,344,224,260,83,348,358,288,49,10,6,235,92,311,199,346,335,255,126,223,225,236,262,3,42,1,128,1,91,130,229,228,289,1,259,181,282,295,251,283,378,264,204,430,74,247,87,76,195,292,149,370,126,53,212,196,115,10,353,100,278,172,41,218,353,42,187,55,11,31,4,331,183,219,122,292,25,294,128,300,57,332,259,149,11,174,34,161,248,34,102,92,143,1,57,91,1,229,165,115,76,177,124,382,269,89,222,7,208,63,264,225,341,262,255,238,268,308,79,225,335,202,355,64,267,101,242,224,1,17,137,27,1,128,1,79,237,256,57,209,60,181,187,102,211,51,266,1,25,184,217,36,154,274,85,233,329,20,143,199,181,287,349,42,214,99,223,181,267,163,268,1,332,219,247,112,1,11,352,60,217,1,165,192,36,185,318,1,152,1,223,209,254,163,263,55,113,213,1,150,169,141,12,275,215,260,130,13,291,58,122,244,30,313,1,127,150,275,373,215,45,343,65,225,1,115,174,120,1,97,267,365,1,204,267,126,334,43,251,327,127,356,70,106,1,108,321,274,297,7,181,285,111,181,191,138,211,230,205,201,211,40,340,1,92,81,227,223,107,126,87,1,282,125,1,277,296,285,384,291,35,217,175,303,159,236,1,11,304,160,67,92,66,138,352,44,18,268,165,134,248,290,319,293,166],[491,286,567,344,324,441,290,387,277,255,204,510,304,228,238,379,361,329,336,481,295,475,494,281,281,471,564,430,224,143,270,437,285,280,543,458,334,287,541,533,270,457,424,278,217,639,345,121,633,453,383,355,292,304,241,242,262,275,410,317,338,328,249,493,172,387,538,577,272,94,482,296,471,306,314,353,130,325,211,304,257,121,451,380,272,192,296,381,451,362,342,413,137,536,413,554,360,384,590,521,281,492,549,309,436,519,468,258,161,236,288,391,356,466,334,472,490,275,547,349,414,193,405,279,399,440,375,345,389,222,589,459,514,406,207,405,281,513,137,377,500,338,484,396,351,437,335,411,225,456,265,400,401,467,398,422,324,460,372,466,387,498,471,296,403,387,396,572,613,571,640,469,640,562,557,452,304,553,523,604,386,439,337,640,639,475,474,558,403,541,564,287,473,234,606,558,467,473,340,458,388,543,390,388,363,413,406,176,332,540,469,434,437,457,613,446,242,487,538,281,355,388,354,277,362,324,551,399,434,379,551,470,385,386,209,434,460,454,307,369,438,187,298,328,340,383,380,122,408,387,416,415,492,487,483,471,369,255,517,400,192,370,482,387,441,537,340,525,372,391,407,315,408,357,521,81,279,393,309,509,340,361,287,385,323,269,404,329,487,396,397,327,334,528,330,500,338,460,499,459,445,518,453,490,507,343,509,447,470,582,420,425,336,639,399,476,294,419,412,619,632,518,361,566,295,625,219,477,458,217,545,168,147,223,132,522,465,389,349,403,216,420,605,307,399,219,236,389,531,597,443,377,430,264,222,368,418,410,438,351,477,462,394,355,640,287,363,562,640,569,306,611],[376,480,106,226,321,480,360,285,381,423,421,470,332,359,406,353,240,279,391,166,267,447,438,372,206,128,102,160,315,333,273,480,198,251,359,480,425,423,420,427,347,332,381,319,228,480,411,154,144,92,259,303,363,117,366,143,166,258,355,215,132,298,399,417,243,392,224,329,471,351,385,206,439,480,408,177,154,114,351,209,449,316,462,456,402,245,329,370,374,389,115,169,103,329,186,286,311,345,431,432,104,464,334,435,449,421,455,480,414,359,457,206,396,301,220,378,447,302,480,312,210,370,337,273,153,480,242,480,324,206,371,480,207,321,206,149,172,153,480,345,364,287,480,221,479,301,480,290,479,479,347,196,395,245,368,479,234,246,268,351,131,260,306,173,468,340,326,213,355,317,479,402,213,441,159,400,283,446,425,480,453,430,426,453,480,247,407,479,308,480,232,467,334,391,400,243,221,354,230,173,291,217,268,454,417,272,427,304,320,379,336,434,272,471,192,205,398,419,230,357,480,295,423,480,205,344,417,404,480,477,294,443,306,387,362,480,350,480,144,480,393,440,298,172,226,480,264,408,123,366,326,225,372,480,178,387,126,407,480,468,366,474,288,295,436,130,358,384,353,226,480,436,479,313,214,450,264,327,370,238,480,196,359,349,480,480,457,266,480,260,447,209,338,387,360,169,312,480,480,196,433,472,355,480,236,439,480,338,480,317,362,153,359,480,480,453,225,392,480,370,432,436,377,436,416,434,422,415,268,480,162,289,294,440,434,303,345,298,159,480,377,167,480,480,480,480,480,259,480,391,480,385,478,113,221,480,388,296,297,294,355,480,265,235,457,368,369,450,474,480,480,394],["BloodImage_00000.xml","BloodImage_00001.xml","BloodImage_00002.xml","BloodImage_00003.xml","BloodImage_00004.xml","BloodImage_00005.xml","BloodImage_00006.xml","BloodImage_00007.xml","BloodImage_00008.xml","BloodImage_00009.xml","BloodImage_00010.xml","BloodImage_00010.xml","BloodImage_00011.xml","BloodImage_00012.xml","BloodImage_00013.xml","BloodImage_00014.xml","BloodImage_00015.xml","BloodImage_00016.xml","BloodImage_00017.xml","BloodImage_00018.xml","BloodImage_00019.xml","BloodImage_00020.xml","BloodImage_00021.xml","BloodImage_00022.xml","BloodImage_00023.xml","BloodImage_00024.xml","BloodImage_00026.xml","BloodImage_00028.xml","BloodImage_00029.xml","BloodImage_00030.xml","BloodImage_00031.xml","BloodImage_00031.xml","BloodImage_00032.xml","BloodImage_00033.xml","BloodImage_00034.xml","BloodImage_00034.xml","BloodImage_00035.xml","BloodImage_00036.xml","BloodImage_00037.xml","BloodImage_00038.xml","BloodImage_00039.xml","BloodImage_00040.xml","BloodImage_00041.xml","BloodImage_00042.xml","BloodImage_00043.xml","BloodImage_00043.xml","BloodImage_00044.xml","BloodImage_00044.xml","BloodImage_00045.xml","BloodImage_00046.xml","BloodImage_00047.xml","BloodImage_00048.xml","BloodImage_00049.xml","BloodImage_00050.xml","BloodImage_00052.xml","BloodImage_00053.xml","BloodImage_00054.xml","BloodImage_00055.xml","BloodImage_00056.xml","BloodImage_00057.xml","BloodImage_00058.xml","BloodImage_00059.xml","BloodImage_00062.xml","BloodImage_00063.xml","BloodImage_00064.xml","BloodImage_00065.xml","BloodImage_00065.xml","BloodImage_00066.xml","BloodImage_00067.xml","BloodImage_00068.xml","BloodImage_00069.xml","BloodImage_00070.xml","BloodImage_00070.xml","BloodImage_00071.xml","BloodImage_00072.xml","BloodImage_00073.xml","BloodImage_00074.xml","BloodImage_00075.xml","BloodImage_00076.xml","BloodImage_00077.xml","BloodImage_00078.xml","BloodImage_00079.xml","BloodImage_00081.xml","BloodImage_00082.xml","BloodImage_00083.xml","BloodImage_00086.xml","BloodImage_00087.xml","BloodImage_00088.xml","BloodImage_00089.xml","BloodImage_00090.xml","BloodImage_00091.xml","BloodImage_00092.xml","BloodImage_00093.xml","BloodImage_00094.xml","BloodImage_00095.xml","BloodImage_00097.xml","BloodImage_00098.xml","BloodImage_00099.xml","BloodImage_00100.xml","BloodImage_00101.xml","BloodImage_00103.xml","BloodImage_00104.xml","BloodImage_00106.xml","BloodImage_00107.xml","BloodImage_00108.xml","BloodImage_00109.xml","BloodImage_00110.xml","BloodImage_00111.xml","BloodImage_00112.xml","BloodImage_00113.xml","BloodImage_00113.xml","BloodImage_00114.xml","BloodImage_00115.xml","BloodImage_00117.xml","BloodImage_00120.xml","BloodImage_00123.xml","BloodImage_00124.xml","BloodImage_00125.xml","BloodImage_00126.xml","BloodImage_00127.xml","BloodImage_00130.xml","BloodImage_00132.xml","BloodImage_00134.xml","BloodImage_00136.xml","BloodImage_00137.xml","BloodImage_00139.xml","BloodImage_00140.xml","BloodImage_00141.xml","BloodImage_00142.xml","BloodImage_00143.xml","BloodImage_00144.xml","BloodImage_00145.xml","BloodImage_00147.xml","BloodImage_00148.xml","BloodImage_00149.xml","BloodImage_00150.xml","BloodImage_00152.xml","BloodImage_00154.xml","BloodImage_00156.xml","BloodImage_00157.xml","BloodImage_00158.xml","BloodImage_00159.xml","BloodImage_00160.xml","BloodImage_00161.xml","BloodImage_00162.xml","BloodImage_00163.xml","BloodImage_00164.xml","BloodImage_00165.xml","BloodImage_00166.xml","BloodImage_00167.xml","BloodImage_00168.xml","BloodImage_00169.xml","BloodImage_00170.xml","BloodImage_00172.xml","BloodImage_00174.xml","BloodImage_00175.xml","BloodImage_00176.xml","BloodImage_00176.xml","BloodImage_00177.xml","BloodImage_00179.xml","BloodImage_00180.xml","BloodImage_00182.xml","BloodImage_00183.xml","BloodImage_00184.xml","BloodImage_00187.xml","BloodImage_00189.xml","BloodImage_00190.xml","BloodImage_00191.xml","BloodImage_00192.xml","BloodImage_00193.xml","BloodImage_00193.xml","BloodImage_00195.xml","BloodImage_00195.xml","BloodImage_00196.xml","BloodImage_00197.xml","BloodImage_00198.xml","BloodImage_00199.xml","BloodImage_00200.xml","BloodImage_00201.xml","BloodImage_00202.xml","BloodImage_00203.xml","BloodImage_00204.xml","BloodImage_00205.xml","BloodImage_00206.xml","BloodImage_00207.xml","BloodImage_00208.xml","BloodImage_00209.xml","BloodImage_00210.xml","BloodImage_00211.xml","BloodImage_00212.xml","BloodImage_00214.xml","BloodImage_00215.xml","BloodImage_00216.xml","BloodImage_00217.xml","BloodImage_00218.xml","BloodImage_00219.xml","BloodImage_00220.xml","BloodImage_00221.xml","BloodImage_00222.xml","BloodImage_00223.xml","BloodImage_00224.xml","BloodImage_00225.xml","BloodImage_00226.xml","BloodImage_00227.xml","BloodImage_00229.xml","BloodImage_00230.xml","BloodImage_00231.xml","BloodImage_00232.xml","BloodImage_00233.xml","BloodImage_00234.xml","BloodImage_00235.xml","BloodImage_00236.xml","BloodImage_00237.xml","BloodImage_00239.xml","BloodImage_00240.xml","BloodImage_00241.xml","BloodImage_00242.xml","BloodImage_00243.xml","BloodImage_00244.xml","BloodImage_00245.xml","BloodImage_00246.xml","BloodImage_00247.xml","BloodImage_00248.xml","BloodImage_00249.xml","BloodImage_00249.xml","BloodImage_00250.xml","BloodImage_00251.xml","BloodImage_00252.xml","BloodImage_00253.xml","BloodImage_00254.xml","BloodImage_00255.xml","BloodImage_00256.xml","BloodImage_00257.xml","BloodImage_00258.xml","BloodImage_00259.xml","BloodImage_00260.xml","BloodImage_00261.xml","BloodImage_00262.xml","BloodImage_00263.xml","BloodImage_00264.xml","BloodImage_00265.xml","BloodImage_00266.xml","BloodImage_00267.xml","BloodImage_00268.xml","BloodImage_00269.xml","BloodImage_00270.xml","BloodImage_00271.xml","BloodImage_00272.xml","BloodImage_00273.xml","BloodImage_00274.xml","BloodImage_00275.xml","BloodImage_00276.xml","BloodImage_00277.xml","BloodImage_00278.xml","BloodImage_00279.xml","BloodImage_00281.xml","BloodImage_00282.xml","BloodImage_00283.xml","BloodImage_00284.xml","BloodImage_00285.xml","BloodImage_00287.xml","BloodImage_00288.xml","BloodImage_00289.xml","BloodImage_00290.xml","BloodImage_00291.xml","BloodImage_00292.xml","BloodImage_00293.xml","BloodImage_00294.xml","BloodImage_00295.xml","BloodImage_00296.xml","BloodImage_00297.xml","BloodImage_00298.xml","BloodImage_00299.xml","BloodImage_00300.xml","BloodImage_00301.xml","BloodImage_00302.xml","BloodImage_00303.xml","BloodImage_00304.xml","BloodImage_00305.xml","BloodImage_00307.xml","BloodImage_00308.xml","BloodImage_00309.xml","BloodImage_00310.xml","BloodImage_00311.xml","BloodImage_00312.xml","BloodImage_00313.xml","BloodImage_00313.xml","BloodImage_00314.xml","BloodImage_00315.xml","BloodImage_00317.xml","BloodImage_00318.xml","BloodImage_00319.xml","BloodImage_00320.xml","BloodImage_00322.xml","BloodImage_00323.xml","BloodImage_00324.xml","BloodImage_00325.xml","BloodImage_00326.xml","BloodImage_00330.xml","BloodImage_00331.xml","BloodImage_00332.xml","BloodImage_00333.xml","BloodImage_00334.xml","BloodImage_00335.xml","BloodImage_00336.xml","BloodImage_00337.xml","BloodImage_00338.xml","BloodImage_00339.xml","BloodImage_00340.xml","BloodImage_00341.xml","BloodImage_00342.xml","BloodImage_00343.xml","BloodImage_00344.xml","BloodImage_00345.xml","BloodImage_00346.xml","BloodImage_00347.xml","BloodImage_00348.xml","BloodImage_00349.xml","BloodImage_00350.xml","BloodImage_00351.xml","BloodImage_00352.xml","BloodImage_00353.xml","BloodImage_00354.xml","BloodImage_00355.xml","BloodImage_00356.xml","BloodImage_00357.xml","BloodImage_00359.xml","BloodImage_00360.xml","BloodImage_00361.xml","BloodImage_00362.xml","BloodImage_00364.xml","BloodImage_00365.xml","BloodImage_00366.xml","BloodImage_00367.xml","BloodImage_00368.xml","BloodImage_00369.xml","BloodImage_00370.xml","BloodImage_00371.xml","BloodImage_00372.xml","BloodImage_00374.xml","BloodImage_00374.xml","BloodImage_00375.xml","BloodImage_00376.xml","BloodImage_00377.xml","BloodImage_00378.xml","BloodImage_00379.xml","BloodImage_00381.xml","BloodImage_00382.xml","BloodImage_00383.xml","BloodImage_00384.xml","BloodImage_00385.xml","BloodImage_00386.xml","BloodImage_00387.xml","BloodImage_00388.xml","BloodImage_00389.xml","BloodImage_00390.xml","BloodImage_00391.xml","BloodImage_00392.xml","BloodImage_00393.xml","BloodImage_00395.xml","BloodImage_00396.xml","BloodImage_00397.xml","BloodImage_00398.xml","BloodImage_00400.xml","BloodImage_00402.xml","BloodImage_00403.xml","BloodImage_00404.xml","BloodImage_00405.xml","BloodImage_00407.xml","BloodImage_00408.xml","BloodImage_00409.xml","BloodImage_00410.xml"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Cells<\/th>\n      <th>xmin<\/th>\n      <th>ymin<\/th>\n      <th>xmax<\/th>\n      <th>ymax<\/th>\n      <th>file_name<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<ul>
<li>Mainly we have one WBC for each image BUT some image have two type of WBC. for example image 10 has two WCB (BloodImage_00010.xml).</li>
</ul>
<p>In the next step we need to add annotation/type of each WBC. The annotation is in the dataframe named <code>WBC_seprate_multiple_label</code> (see above).</p>
</div>
<div id="explore-only-image-with-multiple-wbc" class="section level3">
<h3><span class="header-section-number">1.5.5</span> Explore only image with multiple WBC</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Explore only image with multiple WBC
only_image_multiple_WBC &lt;-<span class="st"> </span>
<span class="st">  </span>WBC_seprate_multiple_label[<span class="kw">duplicated</span>(WBC_seprate_multiple_label<span class="op">$</span>file_name, <span class="dt">fromLast =</span> <span class="ot">FALSE</span>) <span class="op">|</span>
<span class="st">                               </span><span class="kw">duplicated</span>(WBC_seprate_multiple_label<span class="op">$</span>file_name, <span class="dt">fromLast =</span> <span class="ot">TRUE</span>),] 

only_image_multiple_WBC</code></pre></div>
<pre><code>## # A tibble: 30 x 4
## # Groups:   file_name [15]
##    file_name        Image Category   new_file_name     
##    &lt;chr&gt;            &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;             
##  1 BloodImage_00010    10 NEUTROPHIL BloodImage_00010_1
##  2 BloodImage_00010    10 EOSINOPHIL BloodImage_00010_2
##  3 BloodImage_00031    31 NEUTROPHIL BloodImage_00031_1
##  4 BloodImage_00031    31 NEUTROPHIL BloodImage_00031_2
##  5 BloodImage_00034    34 NEUTROPHIL BloodImage_00034_1
##  6 BloodImage_00034    34 BASOPHIL   BloodImage_00034_2
##  7 BloodImage_00043    43 NEUTROPHIL BloodImage_00043_1
##  8 BloodImage_00043    43 MONOCYTE   BloodImage_00043_2
##  9 BloodImage_00044    44 EOSINOPHIL BloodImage_00044_1
## 10 BloodImage_00044    44 EOSINOPHIL BloodImage_00044_2
## # … with 20 more rows</code></pre>
</div>
<div id="merge-all-needed-informations-of-images-with-multiple-wbc-into-dataframe" class="section level3">
<h3><span class="header-section-number">1.5.6</span> Merge all needed informations of images with multiple WBC into dataframe</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Merge all needed informations of images with multiple WBC into dataframe

path_to_images &lt;-<span class="st"> &quot;dataset-master/JPEGImages/&quot;</span>

crops_WBC_df  &lt;-
<span class="st">  </span>xy_limits_WCB <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">file_name =</span> <span class="kw">gsub</span>(<span class="st">&quot;.xml&quot;</span>, <span class="st">&quot;&quot;</span>, file_name)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(file_name) <span class="op">%&gt;%</span>
<span class="st">       </span><span class="kw">mutate</span>(<span class="dt">new_file_name =</span> <span class="cf">if</span>(<span class="kw">n</span>( ) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>) {<span class="kw">paste0</span>(file_name, <span class="st">&quot;_&quot;</span> ,<span class="kw">row_number</span>( ))} 
                            <span class="cf">else</span> {<span class="kw">paste0</span>(file_name)}) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>file_name) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">left_join</span>(only_image_multiple_WBC , <span class="dt">by =</span> <span class="st">&quot;new_file_name&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">drop_na</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">file_path =</span> <span class="kw">paste0</span>(path_to_dataset, file_name, <span class="st">&quot;.jpg&quot;</span>))

DT<span class="op">::</span><span class="kw">datatable</span>(crops_WBC_df)</code></pre></div>
<div id="htmlwidget-350ab50142f8836531e5" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-350ab50142f8836531e5">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26"],["WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC","WBC"],[23,239,127,287,350,310,76,498,196,1,253,404,167,375,107,306,360,418,337,555,70,164,101,180,185,1],[229,253,143,364,181,351,106,304,257,40,275,107,83,348,34,102,124,382,269,89,329,20,373,215,282,125],[204,510,270,437,543,458,217,639,345,121,387,538,296,471,324,460,571,640,469,640,277,362,269,404,403,216],[421,470,273,480,359,480,228,480,411,154,392,224,206,439,234,246,317,479,402,213,480,205,480,457,480,377],["BloodImage_00010_1","BloodImage_00010_2","BloodImage_00031_1","BloodImage_00031_2","BloodImage_00034_1","BloodImage_00034_2","BloodImage_00043_1","BloodImage_00043_2","BloodImage_00044_1","BloodImage_00044_2","BloodImage_00065_1","BloodImage_00065_2","BloodImage_00070_1","BloodImage_00070_2","BloodImage_00176_1","BloodImage_00176_2","BloodImage_00193_1","BloodImage_00193_2","BloodImage_00195_1","BloodImage_00195_2","BloodImage_00249_1","BloodImage_00249_2","BloodImage_00313_1","BloodImage_00313_2","BloodImage_00374_1","BloodImage_00374_2"],["BloodImage_00010","BloodImage_00010","BloodImage_00031","BloodImage_00031","BloodImage_00034","BloodImage_00034","BloodImage_00043","BloodImage_00043","BloodImage_00044","BloodImage_00044","BloodImage_00065","BloodImage_00065","BloodImage_00070","BloodImage_00070","BloodImage_00176","BloodImage_00176","BloodImage_00193","BloodImage_00193","BloodImage_00195","BloodImage_00195","BloodImage_00249","BloodImage_00249","BloodImage_00313","BloodImage_00313","BloodImage_00374","BloodImage_00374"],[10,10,31,31,34,34,43,43,44,44,65,65,70,70,176,176,193,193,195,195,249,249,313,313,374,374],["NEUTROPHIL","EOSINOPHIL","NEUTROPHIL","NEUTROPHIL","NEUTROPHIL","BASOPHIL","NEUTROPHIL","MONOCYTE","EOSINOPHIL","EOSINOPHIL","NEUTROPHIL","NEUTROPHIL","EOSINOPHIL","LYMPHOCYTE","MONOCYTE","LYMPHOCYTE","NEUTROPHIL","EOSINOPHIL","LYMPHOCYTE","LYMPHOCYTE","NEUTROPHIL","NEUTROPHIL","NEUTROPHIL","LYMPHOCYTE","NEUTROPHIL","NEUTROPHIL"],["dataset-master/JPEGImages/BloodImage_00010.jpg","dataset-master/JPEGImages/BloodImage_00010.jpg","dataset-master/JPEGImages/BloodImage_00031.jpg","dataset-master/JPEGImages/BloodImage_00031.jpg","dataset-master/JPEGImages/BloodImage_00034.jpg","dataset-master/JPEGImages/BloodImage_00034.jpg","dataset-master/JPEGImages/BloodImage_00043.jpg","dataset-master/JPEGImages/BloodImage_00043.jpg","dataset-master/JPEGImages/BloodImage_00044.jpg","dataset-master/JPEGImages/BloodImage_00044.jpg","dataset-master/JPEGImages/BloodImage_00065.jpg","dataset-master/JPEGImages/BloodImage_00065.jpg","dataset-master/JPEGImages/BloodImage_00070.jpg","dataset-master/JPEGImages/BloodImage_00070.jpg","dataset-master/JPEGImages/BloodImage_00176.jpg","dataset-master/JPEGImages/BloodImage_00176.jpg","dataset-master/JPEGImages/BloodImage_00193.jpg","dataset-master/JPEGImages/BloodImage_00193.jpg","dataset-master/JPEGImages/BloodImage_00195.jpg","dataset-master/JPEGImages/BloodImage_00195.jpg","dataset-master/JPEGImages/BloodImage_00249.jpg","dataset-master/JPEGImages/BloodImage_00249.jpg","dataset-master/JPEGImages/BloodImage_00313.jpg","dataset-master/JPEGImages/BloodImage_00313.jpg","dataset-master/JPEGImages/BloodImage_00374.jpg","dataset-master/JPEGImages/BloodImage_00374.jpg"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Cells<\/th>\n      <th>xmin<\/th>\n      <th>ymin<\/th>\n      <th>xmax<\/th>\n      <th>ymax<\/th>\n      <th>new_file_name<\/th>\n      <th>file_name<\/th>\n      <th>Image<\/th>\n      <th>Category<\/th>\n      <th>file_path<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,8]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="function-to-plot-cropped-wbc-from-images" class="section level3">
<h3><span class="header-section-number">1.5.7</span> Function to plot cropped WBC from images</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># multiple plot of crops</span>
multiple_plot_crops &lt;-<span class="st"> </span><span class="cf">function</span>(df){
  l &lt;-<span class="st"> </span><span class="kw">nrow</span>(df)
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>l){
    <span class="kw">attach</span>(df)
  img &lt;-<span class="st"> </span>EBImage<span class="op">::</span><span class="kw">readImage</span>(file_path[i])
  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
   <span class="kw">plot</span>(img)
   <span class="kw">title</span>(<span class="dt">main=</span> <span class="kw">paste0</span>(<span class="st">&quot;Img.&quot;</span>,Image[i]), <span class="dt">cex.main =</span> <span class="fl">0.5</span>, <span class="dt">cex.sub =</span> <span class="fl">0.75</span>)
   <span class="kw">plot</span>(img[xmin[i] <span class="op">:</span><span class="st"> </span>xmax[i], ymin[i] <span class="op">:</span><span class="st"> </span>ymax[i],])
   <span class="kw">title</span>(<span class="dt">main =</span> Category[i], <span class="dt">cex.main =</span> <span class="fl">0.5</span>, <span class="dt">cex.sub =</span> <span class="fl">0.75</span>)
   <span class="kw">detach</span>(df)
  }
}


 
 
<span class="co"># l &lt;- nrow(crops_WBC_df)</span>
<span class="co"># par(mfrow = c(l,1))</span>
<span class="kw">multiple_plot_crops</span>(crops_WBC_df)</code></pre></div>
<p><img src="White_blood_cell_files/figure-html/unnamed-chunk-11-1.png" width="192" /><img src="White_blood_cell_files/figure-html/unnamed-chunk-11-2.png" width="192" /><img src="White_blood_cell_files/figure-html/unnamed-chunk-11-3.png" width="192" /><img src="White_blood_cell_files/figure-html/unnamed-chunk-11-4.png" width="192" /><img src="White_blood_cell_files/figure-html/unnamed-chunk-11-5.png" width="192" /><img src="White_blood_cell_files/figure-html/unnamed-chunk-11-6.png" width="192" /><img src="White_blood_cell_files/figure-html/unnamed-chunk-11-7.png" width="192" /><img src="White_blood_cell_files/figure-html/unnamed-chunk-11-8.png" width="192" /><img src="White_blood_cell_files/figure-html/unnamed-chunk-11-9.png" width="192" /><img src="White_blood_cell_files/figure-html/unnamed-chunk-11-10.png" width="192" /><img src="White_blood_cell_files/figure-html/unnamed-chunk-11-11.png" width="192" /><img src="White_blood_cell_files/figure-html/unnamed-chunk-11-12.png" width="192" /><img src="White_blood_cell_files/figure-html/unnamed-chunk-11-13.png" width="192" /><img src="White_blood_cell_files/figure-html/unnamed-chunk-11-14.png" width="192" /><img src="White_blood_cell_files/figure-html/unnamed-chunk-11-15.png" width="192" /><img src="White_blood_cell_files/figure-html/unnamed-chunk-11-16.png" width="192" /><img src="White_blood_cell_files/figure-html/unnamed-chunk-11-17.png" width="192" /><img src="White_blood_cell_files/figure-html/unnamed-chunk-11-18.png" width="192" /><img src="White_blood_cell_files/figure-html/unnamed-chunk-11-19.png" width="192" /><img src="White_blood_cell_files/figure-html/unnamed-chunk-11-20.png" width="192" /><img src="White_blood_cell_files/figure-html/unnamed-chunk-11-21.png" width="192" /><img src="White_blood_cell_files/figure-html/unnamed-chunk-11-22.png" width="192" /><img src="White_blood_cell_files/figure-html/unnamed-chunk-11-23.png" width="192" /><img src="White_blood_cell_files/figure-html/unnamed-chunk-11-24.png" width="192" /><img src="White_blood_cell_files/figure-html/unnamed-chunk-11-25.png" width="192" /><img src="White_blood_cell_files/figure-html/unnamed-chunk-11-26.png" width="192" /></p>
<ul>
<li>At this step We can avoid image with two kinds of WBC.</li>
<li>We can crop all WBC and get our unicellular dataset.</li>
</ul>
<p>Now we will crop all WBC for all images and class them to its categories.</p>
</div>
<div id="merge-all-needed-informations-of-all-images-in-dataset-master-into-dataframe" class="section level3">
<h3><span class="header-section-number">1.5.8</span> Merge all needed informations of all images in dataset-master into dataframe</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># we need: `xy_limits_WCB` and `WBC_seprate_multiple_label` dataframes</span>

path_to_images &lt;-<span class="st"> &quot;dataset-master/JPEGImages/&quot;</span>

all_crops_WBC_df  &lt;-
<span class="st">  </span>xy_limits_WCB <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">file_name =</span> <span class="kw">gsub</span>(<span class="st">&quot;.xml&quot;</span>, <span class="st">&quot;&quot;</span>, file_name)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(file_name) <span class="op">%&gt;%</span>
<span class="st">       </span><span class="kw">mutate</span>(<span class="dt">new_file_name =</span> <span class="cf">if</span>(<span class="kw">n</span>( ) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>) {<span class="kw">paste0</span>(file_name, <span class="st">&quot;_&quot;</span> ,<span class="kw">row_number</span>( ))} 
                            <span class="cf">else</span> {<span class="kw">paste0</span>(file_name)}) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>file_name) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">left_join</span>(WBC_seprate_multiple_label , <span class="dt">by =</span> <span class="st">&quot;new_file_name&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">drop_na</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">file_path =</span> <span class="kw">paste0</span>(path_to_dataset, file_name, <span class="st">&quot;.jpg&quot;</span>))</code></pre></div>
</div>
</div>
<div id="description-of-the-second-dataset" class="section level2">
<h2><span class="header-section-number">1.6</span> Description of the second dataset</h2>
<p>The second dataset directory named <code>dataset2-master</code> contains image folder for each class of WBC and csv file that label images.</p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
